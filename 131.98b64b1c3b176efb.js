"use strict";(self.webpackChunktenant_ui=self.webpackChunktenant_ui||[]).push([[131],{6131:(R,l,o)=>{o.r(l),o.d(l,{MarketplaceModule:()=>S});var h=o(9808),s=o(1083),m=o(1978),c=o(1448),f=o(2340),r=o(5e3),d=o(520);let v=(()=>{class e{constructor(t){this.http=t}getMarketPlaceToken(t){return this.http.get(`${f.N.nodeServerURL}/token-manager/auth/marketplace/azure`,{headers:{"x-amber-marketplace-token":t}})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(d.eN))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var g=o(8555),p=o(9444);const M=[{path:"azure",component:(()=>{class e{constructor(t,i,a,u,I,C,y){this.msalGuardConfig=t,this.authService=i,this.marketplaceService=a,this.route=u,this.loaderService=I,this.subjectService=C,this.router=y}ngOnInit(){this.loaderService.isLoading.next(!0);const t=this.route.snapshot.queryParamMap.get("token");this.subjectService.csrfToken.subscribe(i=>{i&&this.marketplaceService.getMarketPlaceToken(t).subscribe(a=>{a.userInfos.status===c.g.MARKETPLACE_STATUS_ACTIVE?this.login():a.userInfos.status===c.g.MARKETPLACE_STATUS_INACTIVE?(localStorage.setItem(c.g.USER_INFO,JSON.stringify({id:a.userInfos.user_id,email:a.userInfos.email,active:a.userInfos.active,created_at:"",status:a.userInfos.status,privacy_acknowledgement:a.userInfos.privacy_acknowledgement,source:a.userInfos.source,tenant_roles:[{tenant_id:a.userInfos.tenant_id,roles:[{id:a.userInfos.role.id,name:a.userInfos.role.name,permissions:a.userInfos.permissions}]}]})),localStorage.setItem(c.g.SOURCE,a.userInfos.source),location.href=`${f.N.portalPath}home`):this.router.navigate(["/error/unauthorized"])})})}login(){this.msalGuardConfig.authRequest?this.authService.loginRedirect(Object.assign({},this.msalGuardConfig.authRequest)):this.authService.loginRedirect()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(m.S9),r.Y36(m.W2),r.Y36(v),r.Y36(s.gz),r.Y36(g.D),r.Y36(p._),r.Y36(s.F0))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-marketplace"]],decls:0,vars:0,template:function(t,i){},styles:[""]}),e})()}];let k=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[s.Bz.forChild(M)],s.Bz]}),e})(),S=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,k]]}),e})()}}]);